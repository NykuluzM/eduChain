<?xml version="1.0" encoding="UTF-8" ?>
<Shell
    x:Class="eduChain.AppShell"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:local="clr-namespace:eduChain"
    xmlns:pages="clr-namespace:eduChain.Views.ContentPages"
    xmlns:viewmodel="clr-namespace:eduChain.ViewModels"
    xmlns:preferences="Microsoft.Maui.Storage; Assembly=Microsoft.Maui"
    xmlns:models="clr-namespace:eduChain.Models"
    FlyoutBackgroundColor="LightGray"  FlyoutWidth="270" FlyoutBackdrop="#66FFFFFF"
    Title="eduChain" >
       
    <Shell.Resources>
        <ResourceDictionary>
            <LinearGradientBrush x:Key="grad" EndPoint="0,1">
                <GradientStop
                 Offset = "0" Color="#6C06E6" />
                <GradientStop Offset = "1" Color="#FF228B" />
            </LinearGradientBrush>
        </ResourceDictionary>
    </Shell.Resources>
    
    <Shell.FlyoutHeader >
        <Border Stroke="#C49B33" StrokeThickness="4">
            <Border.GestureRecognizers>
                <TapGestureRecognizer Tapped="ProfileTapped" />
            </Border.GestureRecognizers>
            <Grid ColumnDefinitions="Auto, *" RowDefinitions="Auto, Auto" BackgroundColor="#41406d">
                <Border Grid.Column="0" HeightRequest="65" WidthRequest="65"
                    Stroke="{StaticResource grad}" StrokeThickness="2">
                    <Border.StrokeShape>
                        <Ellipse />
                    </Border.StrokeShape>
                    <Image x:Name="ProfileImage" Source="{Binding Profile.ProfileImage}" Aspect="AspectFill"/>
                </Border>
                <Label Grid.Column="1" Grid.Row="0"  Text="{Binding Profile.FullName}" TextColor="Black" FontSize="15" x:Name="Name" HorizontalOptions="Center" VerticalOptions="Center" HeightRequest="30" />
                <Label Grid.Column="1" Grid.Row="0"  Margin="0,0,0,5" Text="{Binding Profile.Role}" TextDecorations="Underline" TextColor="Yellow" HeightRequest="20" x:Name="Role" FontSize="15" HorizontalOptions="Center" VerticalOptions="End"/>
            </Grid>
        </Border>
        
    </Shell.FlyoutHeader>

    <Shell.ItemTemplate>
        <DataTemplate>
            <Grid ColumnSpacing="10" RowDefinitions="7,Auto,7,1" ColumnDefinitions="50,*">
                <VisualStateManager.VisualStateGroups>
                    <VisualStateGroupList>
                        <VisualStateGroup x:Name="CommonStates">
                            <VisualState x:Name="Normal">
                                <VisualState.Setters>
                                    <Setter Property="BackgroundColor" Value="LightGray"/>
                                </VisualState.Setters>
                            </VisualState>
                            <VisualState x:Name="Selected">
                                <VisualState.Setters>
                                    <Setter Property="BackgroundColor" Value="LightGreen" />
                                </VisualState.Setters>
                            </VisualState>
                        </VisualStateGroup>
                    </VisualStateGroupList>

                </VisualStateManager.VisualStateGroups>
                <Image Grid.Row="1" Grid.Column="0" Source="{Binding FlyoutIcon}" WidthRequest="30" />
                <Label Grid.Row="1" Grid.Column="1" Text="{Binding Title}" FontSize="15" VerticalOptions="Center" TextColor="Black" FontAttributes="Bold" WidthRequest="{x:OnPlatform WinUI= 350}"/>
                <BoxView Grid.Row="3" Color="GreenYellow" Grid.Column="0" Grid.ColumnSpan="2"/>
            </Grid>
        </DataTemplate>
    </Shell.ItemTemplate>

    <ShellContent 
        FlyoutItemIsVisible="False"
        ContentTemplate="{DataTemplate pages:InitializingPage}"
        Route="loadingPage"
                          /> 
    <ShellContent
        Title="Login"
        FlyoutItemIsVisible="False"
        ContentTemplate="{DataTemplate pages:LoginPage}"
        Route="loginPage" />

	
    <FlyoutItem Title="Home" FlyoutDisplayOptions="AsMultipleItems">
        <ShellContent
            Title="Home"
            FlyoutIcon="homelogo.png"
            FlyoutItemIsVisible="True"
            Icon="homelogo.png"
            Shell.NavBarIsVisible="{x:OnPlatform Android=True, iOS=True, MacCatalyst=True, WinUI=False}"
			Shell.TabBarBackgroundColor="#FFFACD"
            Shell.TabBarForegroundColor="DarkSeaGreen"
            Shell.TabBarUnselectedColor="Black"
            Shell.TabBarTitleColor="Green"
            Shell.FlyoutBehavior="Flyout"
            ContentTemplate="{DataTemplate pages:HomePage}"
            Route="homePage" />
        
            <ShellContent
                Title="Settings"
                FlyoutItemIsVisible="False"
                Icon="settingslogo.png"
                Shell.NavBarIsVisible="{x:OnPlatform Android=True, iOS=True, MacCatalyst=True, WinUI=False}"
                Shell.TabBarBackgroundColor="#FFFACD"
                Shell.TabBarForegroundColor="DarkSeaGreen"
                Shell.TabBarUnselectedColor="Black"
                Shell.TabBarTitleColor="Green"
                Shell.FlyoutBehavior="Flyout"
                ContentTemplate="{DataTemplate pages:SettingsPage}"
                Route="settingsPage"
                />
    </FlyoutItem>


    <FlyoutItem Title="School Website" FlyoutDisplayOptions="AsMultipleItems">
        <ShellContent
            Title="Site"
            FlyoutIcon="weblogo.png"
            Icon="weblogo.png"
            FlyoutItemIsVisible="True"
            Shell.NavBarIsVisible="{x:OnPlatform Android=True, iOS=True, MacCatalyst=True, WinUI=False}"
            Shell.FlyoutBehavior="Flyout"
            Shell.TabBarBackgroundColor="#FFFACD"
            Shell.TabBarForegroundColor="DarkSeaGreen"
            Shell.TabBarUnselectedColor="Black"
            Shell.TabBarTitleColor="Green"
            ContentTemplate="{DataTemplate pages:WebConnectPage}"
            Route="webConnectPage"
        />
        <ShellContent
            Title="Settings"
            FlyoutItemIsVisible="False"
            Icon="settingslogo.png"
            Shell.NavBarIsVisible="{x:OnPlatform Android=True, iOS=True, MacCatalyst=True, WinUI=False}"
            Shell.FlyoutBehavior="Flyout"
            Shell.TabBarBackgroundColor="#FFFACD"
            Shell.TabBarForegroundColor="DarkSeaGreen"
            Shell.TabBarUnselectedColor="Black"
            Shell.TabBarTitleColor="Green"
            ContentTemplate="{DataTemplate pages:SettingsPage}"
            Route="settingsPage"
    />
    </FlyoutItem>

    <FlyoutItem Title="IPFS" FlyoutDisplayOptions="AsMultipleItems">
        <ShellContent
            Title="IPFS"
            FlyoutIcon="ipfslogo.png"
            Icon="ipfslogo.png"
            FlyoutItemIsVisible="True"
            Shell.NavBarIsVisible="{x:OnPlatform Android=True, iOS=True, MacCatalyst=True, WinUI=False}"
            Shell.FlyoutBehavior="Flyout"
            ContentTemplate="{DataTemplate pages:IpfsConnectPage}"
            Route="ipfsConnectPage"
            />
    </FlyoutItem>
    <FlyoutItem IsVisible="False">
        <ShellContent
            Icon="profilelogo"
            FlyoutItemIsVisible="False"
            Shell.NavBarIsVisible="{x:OnPlatform Android=True, iOS=True, MacCatalyst=True, WinUI=True}"
            Shell.FlyoutBehavior="Flyout"
            Shell.TabBarIsVisible="False"
            ContentTemplate="{DataTemplate pages:MyProfilePage}"
            Route="myProfilePage" 
        />
    </FlyoutItem>
        <ShellContent
            FlyoutItemIsVisible="False"
            Shell.FlyoutBehavior="Disabled"
            ContentTemplate="{DataTemplate pages:LoadingOnePage}"
            Route="loadingOnePage"
            />

        <Shell.FlyoutFooter>
       <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" /> <!-- Row for Button -->
            <RowDefinition Height="*" /> <!-- Row for existing content -->
        </Grid.RowDefinitions>

        <!-- Button in the first row -->
        <Button x:Name="Logout" MinimumWidthRequest="150" FontSize="15" Text="Logout" Clicked="OnLogoutClicked" HorizontalOptions="CenterAndExpand" Margin="0,0,0,30" 
                Grid.Row="0"/>

        <!-- Existing content in the second row -->
    </Grid>        
    </Shell.FlyoutFooter>
</Shell>
